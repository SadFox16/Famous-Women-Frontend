(function(){"use strict";var s={7582:function(s,t,e){var i=e(9242),r=e(3396),o=e(7139);const n=(0,r._)("h1",null,"Famous Women",-1),a={class:"error"},l={key:0,id:"login",class:"login"},h=(0,r._)("h1",null,"Логин:",-1),g=(0,r._)("h1",null,"Пароль:",-1),_={key:1,id:"register",class:"register"},c={class:"login"},u=(0,r._)("h1",null,"Придумайте логин:",-1),w={class:"password"},f=(0,r._)("h1",null,"Придумайте пароль:",-1),d={class:"password"},p=(0,r._)("h1",null,"Повторите пароль:",-1),m={key:2,id:"main",class:"main"},k={key:0};function v(s,t,e,v,y,b){return(0,r.wg)(),(0,r.iD)(r.HY,null,[n,(0,r._)("h1",a,(0,o.zw)(y.err),1),b.is_show_login()?((0,r.wg)(),(0,r.iD)("div",l,[h,(0,r.wy)((0,r._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>y.login.username=s),class:"user_name"},null,512),[[i.nr,y.login.username]]),g,(0,r.wy)((0,r._)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=s=>y.login.password=s),class:"user_pwd"},null,512),[[i.nr,y.login.password]]),(0,r._)("div",null,[(0,r._)("button",{onClick:t[2]||(t[2]=s=>b.do_login()),class:"login_click"},"Логин"),(0,r._)("button",{onClick:t[3]||(t[3]=s=>b.do_register()),class:"register_click"},"Регистрация")])])):(0,r.kq)("",!0),b.is_show_register()?((0,r.wg)(),(0,r.iD)("div",_,[(0,r._)("div",c,[u,(0,r.wy)((0,r._)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=s=>y.register.username=s),class:"user_name"},null,512),[[i.nr,y.register.username]])]),(0,r._)("div",w,[f,(0,r.wy)((0,r._)("input",{type:"password","onUpdate:modelValue":t[5]||(t[5]=s=>y.register.password=s),class:"user_pwd"},null,512),[[i.nr,y.register.password]])]),(0,r._)("div",d,[p,(0,r.wy)((0,r._)("input",{type:"password","onUpdate:modelValue":t[6]||(t[6]=s=>y.register.password2=s),class:"user_pwd"},null,512),[[i.nr,y.register.password2]])]),(0,r._)("button",{onClick:t[7]||(t[7]=s=>b.registrate()),class:"register_click"},"Регистрация"),(0,r._)("button",{onClick:t[8]||(t[8]=s=>b.back()),class:"register_click"},"Назад")])):(0,r.kq)("",!0),b.is_show_main()?((0,r.wg)(),(0,r.iD)("div",m,[(0,r._)("header",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(y.categories,(s=>((0,r.wg)(),(0,r.iD)("li",{key:s,class:"categories"},(0,o.zw)(s),1)))),128))]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(y.allposts,(s=>((0,r.wg)(),(0,r.iD)("li",{key:s,class:"allposts"},(0,o.zw)(s),1)))),128)),(0,r._)("button",{onClick:t[9]||(t[9]=s=>b.logout()),class:"register_click"},"Выход"),b.user_admin()?((0,r.wg)(),(0,r.iD)("div",k,[(0,r._)("button",{onClick:t[10]||(t[10]=s=>b.logout()),class:"admin_button"},"Админ")])):(0,r.kq)("",!0)])):(0,r.kq)("",!0)],64)}e(2087);var y=e(6265),b=e.n(y),O={data(){return{login:{username:"",password:"",is_admin:!1},flags:{show_main:!1,show_login:!0,show_register:!1},register:{username:"",password:"",password2:""},token:"",err:"",allposts:{},categories:{}}},created(){},mounted(){this.check_token(),this.get_all()},methods:{do_login(){this.err="",this.is_show_login(),this.flags.show_login=!0,this.flags.show_main=!1,this.flags.show_register=!1,b().post("http://127.0.0.1:8000/auth/login/",{username:this.login.username,password:this.login.password}).then((s=>{localStorage.setItem("access_token",JSON.stringify(s.data.access)),localStorage.setItem("refresh_token",JSON.stringify(s.data.refresh)),this.token=JSON.parse(localStorage.getItem("access_token")),this.flags.show_login=!1,this.flags.show_main=!0,this.flags.show_register=!1,this.is_show_main(),this.get_all(),"admin"==this.username&&this.user_admin()})).catch((s=>{console.log("Error login"),console.log(s),this.err="",this.err="Данные указаны неверно, авторизация невозможна!",this.flags.show_login=!0,this.flags.show_main=!1,this.flags.show_register=!1})),this.flags.show_login=!1,this.flags.show_main=!0,this.flags.show_register=!1,this.get_category_list(),this.is_show_main()},is_show_login(){return 1==this.flags.show_login},user_admin(){return 1==this.login.is_admin},registrate(){this.err="",this.is_show_register(),b().post("http://127.0.0.1:8000/auth/register/",{username:this.register.username,password:this.register.password,password2:this.register.password2}).then((s=>{this.flags.show_login=!0,this.flags.show_main=!1,this.flags.show_register=!1})).catch((s=>{console.log("Error reg"),console.log(s),this.is_show_register(),this.flags.show_register=!0,this.reg_error=s,this.err="",this.err="Неверно указаны данные, регистрация невозможна!"})),this.flags.show_login=!1,this.flags.show_main=!1,this.flags.show_register=!0},is_show_register(){return 1==this.flags.show_register},do_register(){this.err="",this.flags.show_login=!1,this.flags.show_main=!1,this.flags.show_register=!0},back(){this.err="",this.flags.show_login=!0,this.flags.show_main=!1,this.flags.show_register=!1},check_token(){this.err="",this.token=JSON.parse(localStorage.getItem("access_token")),this.token?b().post("http://127.0.0.1:8000/api/token/verify/",{token:this.token}).then((s=>{401==s.status?(this.flags.show_login=!0,this.flags.show_main=!1,this.flags.show_register=!1):(this.flags.show_login=!1,this.flags.show_main=!0,this.flags.show_register=!1)})).catch((s=>{console.log("Error auth"),console.log(s),this.err="",this.err="Вы не авторизованы!"})):this.logout()},logout(){this.err="",localStorage.removeItem("access_token"),this.flags.show_login=!0,this.flags.show_main=!1,this.flags.show_register=!1,this.err="",this.err="Вы вышли из учетной записи"},get_all(){this.err="",this.token=JSON.parse(localStorage.getItem("access_token")),this.flags.show_main=!0,this.flags.show_login=!1,this.flags.show_register=!1,this.is_show_main(),b().get("http://127.0.0.1:8000/user/women/",{},{headers:{Authorization:"Bearer "+this.token}}).then((s=>{this.is_show_main(),this.flags.show_main=!0,this.allposts=s.data})).catch((s=>{console.log("Error getAll"),console.log(s),this.err="",this.err="Невозможно получить записи!"})),this.is_show_main()},is_show_main(){return 1==this.flags.show_main},get_category_list(){this.err="",b().get("http://127.0.0.1:8000/http://127.0.0.1:8000/user/category",{},{headers:{Authorization:"Bearer "+this.token}}).then((s=>{this.categories=s.data})).catch((s=>{console.log("Error get_category_list"),console.log(s),this.err="",this.err="Невозможно получить категории!"}))}}},S=e(89);const D=(0,S.Z)(O,[["render",v]]);var C=D;(0,i.ri)(C).mount("#app")}},t={};function e(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return s[i](o,o.exports,e),o.exports}e.m=s,function(){var s=[];e.O=function(t,i,r,o){if(!i){var n=1/0;for(g=0;g<s.length;g++){i=s[g][0],r=s[g][1],o=s[g][2];for(var a=!0,l=0;l<i.length;l++)(!1&o||n>=o)&&Object.keys(e.O).every((function(s){return e.O[s](i[l])}))?i.splice(l--,1):(a=!1,o<n&&(n=o));if(a){s.splice(g--,1);var h=r();void 0!==h&&(t=h)}}return t}o=o||0;for(var g=s.length;g>0&&s[g-1][2]>o;g--)s[g]=s[g-1];s[g]=[i,r,o]}}(),function(){e.n=function(s){var t=s&&s.__esModule?function(){return s["default"]}:function(){return s};return e.d(t,{a:t}),t}}(),function(){e.d=function(s,t){for(var i in t)e.o(t,i)&&!e.o(s,i)&&Object.defineProperty(s,i,{enumerable:!0,get:t[i]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(s){if("object"===typeof window)return window}}()}(),function(){e.o=function(s,t){return Object.prototype.hasOwnProperty.call(s,t)}}(),function(){var s={143:0};e.O.j=function(t){return 0===s[t]};var t=function(t,i){var r,o,n=i[0],a=i[1],l=i[2],h=0;if(n.some((function(t){return 0!==s[t]}))){for(r in a)e.o(a,r)&&(e.m[r]=a[r]);if(l)var g=l(e)}for(t&&t(i);h<n.length;h++)o=n[h],e.o(s,o)&&s[o]&&s[o][0](),s[o]=0;return e.O(g)},i=self["webpackChunkfamouswomenfrontend"]=self["webpackChunkfamouswomenfrontend"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=e.O(void 0,[998],(function(){return e(7582)}));i=e.O(i)})();
//# sourceMappingURL=app.76aee603.js.map